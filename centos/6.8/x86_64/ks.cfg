# Kickstart file automatically generated by anaconda.

# Install OS instead of upgrade
install

# Install from attached ISO
cdrom

# Text installation
text
skipx

# Set language
lang en_NZ.UTF-8

# Set keyboard
keyboard us

# Disable firstboot
firstboot --disabled

# Configure network using DHCP and disable IPv6
network --onboot yes --device eth0 --bootproto dhcp 

# Set default root password
rootpw  --iscrypted $6$AfcUH/7TqRsC9BJI$5v3kgDNXBYxGJwEjRlb/gneHALcmpHeSq37/IgxviTy4wExWLwHmxUadHnVrkknvFE0X9ZU4Qj.GA8WCSbRMe0

# Allow SSH access via the firewall 
firewall --service=ssh

# Use stronger passwords
authconfig --enableshadow --passalgo=sha512

# Enable SELINUX
selinux --enforcing

# Set timezone
timezone --utc Pacific/Auckland

# Boot config
bootloader --location=mbr --driveorder=sda --append="nomodeset crashkernel=auto rhgb quiet --ipv6=off"

# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
zerombr

autopart

# Create user for vagrant to login
user --name=vagrant --groups=wheel --password=vagrant

# Reboot the server after installation completes
reboot

%packages --nobase
@core
wget.x86_64
%end

%post

# Backup all the original config from /etc
#mkdir /backups 
#tar czvf etc-$(date "+%F")-orig.tar.gz /etc >> /backups/backup.log


# Enabling sudo-less access for vagrant u

/usr/bin/yum -y clean all

/bin/dd if=/dev/zero of=/boot/EMPTY bs=1M
/bin/rm -f /boot/EMPTY
/bin/dd if=/dev/zero of=/EMPTY bs=1M
/bin/rm -f /EMPTY

%end
